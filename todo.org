#+TITLE: Todo

* Presubmission [6/6]:
** DONE Update .rda to new universalmotif
** DONE change tomtom pvalue -> pval, etc. to match universalmotif_df format
*** DONE Change the tomtom_df that gets returned & nested
*** DONE change the nest_tomtom functions to grab new colnames
*** DONE Update docs accordingly
** DONE view_tomtom_hits %>% cowplot subscript out of bounds error
doesn't reproduce on my local image, try pulling newest docker image & trying again.
- Candidate issue: https://github.com/wilkelab/cowplot/blame/901173d7a7db61f3e8883944dda8e5181fc2625f/R/plot_grid.R
  - see line ~180
** DONE runFimo skip_matched_sequence = TRUE a good default??
Consider swapping to FALSE. This may be a premature optimization.
** DONE Double check that runDreme and runMeme docs show correct colnames for return values
** DONE runTomTom dist=ed
Make this change before you submit so it's the default!!
- Change tomtom vignette & tests to ensure correct behavior
* Post submission [1/6]:
** TODO update example_dreme_tomtom, and example_tomtom after dist=ed
** DONE https://bioconductor.org/developers/how-to/git/new-package-workflow/
** TODO fix cmdfun::cmd_ui_file_exists
If path = NULL, then when it gets passed to cmd_ui_file_exists(path), get a "path must be character" error.

To fix, catch if path = NULL after if(class(x) == "try-error") & return FALSE.
```
x <- try(path_search(path = path) %>% cmd_ui_file_exists(),
        silent = TRUE)
    if (is(x, "try-error")) {
        cmd_ui_file_exists(path)
        return(invisible(NULL))
    }
```
*** DONE TEMPORARY FIX for memes
Trycatch this warning if path == NULL
** TODO add bioconductor_docker_meme instructions to install vignette?
** TODO update README
** TODO Support STREME & ENR
* Review [1/7]:
** DONE double check all <<- that they're safe
** TODO run bfg to remove >5MB files
** TODO reduce function length < 50 lines?
** TODO check that view_tomtom_results losing \donttest works
** TODO ensure all TODO's are OK
** TODO buff up chip-seq vignette with more text
** WAIT version bump & push to bioc

* TODO Review response:


> `[1] "Avoid '<<-' if possible (found in 3 files)" `
In this case, I'd prefer to keep my `<<-` if at all possible. Their use is well scoped inside a `purrr::map` loop (i.e. the next environment up is scoped within my function and won't affect the user's env). I could redo this with a couple of `for` loops, but `purrr` gives me a little extra type safety for the final return value which I'd like to hold onto if that's alright.

> `[2] "Recommended function length <= 50 lines."`

I generally dislike long functions, but the few instances I have big ones are
big for a reason. The `ame_plot_heatmap` function has lots of plotting code, so
it's a little easier to have everything in 1 big function than break things up
here to avoid bugs from getting the nonstandard eval correct. Since it's
difficult to unit test plots, I decided on this approach to hopefully limit
bugs. `ame_order_by_cluster` is large because I did a little ASCII cartoon in the
comments to explain the algorithm.

> `[3] "Usage of dontrun{} / donttest{} found in man page examples."`
These are limited to examples of functions that write data to disk to prevent
writing junk to the build machine or userspace. In these cases I wrap it in
`\donttest`. Should I put these in `\dontrun` instead of `\donttest` to prevent
this further? I'm not sure how `\donttest` chunks are evaluated vs `\dontrun` in this situation.

> I also noticed in a vignette "Tidying motif metadata":
>
> ```
> As of this writing in May 2020, the FBgn entries are out of date
> ```
This issue is actually upstream of `memes` and comes from the FlyFactor Survey database. I added a new paragraph explaining this issue in more detail and fleshing out the reasoning behind using this example. In short, the purpose of the vignette is to give users practical examples on how to use the `universalmotif_df` format to explore and clean messy data. I lean on this messiness to give good real-world examples for how to evaluate motif annotations and tidy their metadata.


> It looks like there are various "TODO"s around. Let me know when you think I should go over this again.
I went back through and double checked all my TODO's and ensured I wasn't leaving anything undone. In particular I fixed the ones in the vignettes that were being rendered out now that the latest `universalmotif` version is up on the devel branch. There's still 1 TODO in the `integrative_analys.Rmd` vignette but it's not rendered out or evaluated, just a future note for possible improvement on the document. I can remove that chunk if it may cause issues somewhere.

The remaining TODO flags mark things that may need attention in the future if I make changes to that area of the code, but should be stable under current conditions.
